:root{
  --headerH: 64px;
  --ty: 0px;
  --rx: 0deg;
  --ry: 0deg;
}

html.route-loading-active,
body.route-loading-active{
  overflow: hidden;
  overscroll-behavior: none;
  height: 100%;
}

/* ---------- Fondo + tipografía ---------- */
body{
  background:#0A0A0B;
  color:var(--white-100);
  font-family:"Quantico", system-ui, Segoe UI, Roboto, Ubuntu, Arial;
  overflow-x:hidden;
  min-height:100vh;
}

/* Texturas: por ENCIMA del color de body y por DEBAJO del contenido */
#comic-bg{
  position:fixed; inset:0;
  pointer-events:none;
  z-index:0;
  background-image: url('../img/comic/textures/scratched_steel.jpg');
  background-position:center center;
  background-size:cover,600px 600px;
  background-repeat:no-repeat,repeat;
  mix-blend-mode:darken;
  opacity:0.2;
}

/* ---------- Header sin fondo ni blur (transparente) ---------- */
.main-header{
  position:fixed; top:0; left:0; right:0;
  height:var(--headerH);
  display:flex; align-items:center; justify-content:space-between;
  padding-inline:clamp(14px,5vw,32px);
  padding-left:max(env(safe-area-inset-left),clamp(14px,5vw,32px));
  padding-right:max(env(safe-area-inset-right),clamp(14px,5vw,32px));
  background:none !important; border-bottom:none !important; backdrop-filter:none !important;
  z-index:120;
}

#comic-view{
  position:relative;
  overflow-x:hidden;     
  padding-top:var(--headerH);
  z-index:1;
  min-height:100vh;     
}


/* Scrollbar (WebKit) */
#comic-view::-webkit-scrollbar{ width:10px; }
#comic-view::-webkit-scrollbar-track{ background:transparent; }
#comic-view::-webkit-scrollbar-thumb{
  background:linear-gradient(180deg,#3a3a42,#2b2b30);
  border-radius:10px; border:2px solid transparent; background-clip:content-box;
}
#comic-view::-webkit-scrollbar-thumb:hover{
  background:linear-gradient(180deg,#4a4a52,#3a3a42);
}

/* ---------- VIÑETAS PRINCIPALES ---------- */

/* Base: móvil (márgenes pequeños) */
.vignette{
  position:relative;
  perspective:1000px;
  margin:4vh auto;
}

/* Tablet / pantallas medias */
@media (min-width:768px){
  .vignette{
    margin:14vh auto;
  }
}

/* Desktop grande (1920x1080, etc.) */
@media (min-width:1200px){
  .vignette{
    margin:30vh auto;   /* ya no 30vh, queda más compacto */
  }
}

/* Páginas normales del cómic (no las rutas) */
.vignette:not(.is-tease){
  max-width:min(1200px, 100%);
}

/* La PRIMERA viñeta pegada al header, pero con espacio hacia abajo */
#comic-view .vignette:first-child{
  margin-top:0;
  margin-bottom:6vh;
}

/* Capas: imagen completa y SIN fondo opaco */
.vignette .layer{
  position:absolute; inset:0;
  background-repeat:no-repeat;
  background-position:center center;
  background-size:contain;
  background-color:transparent;
  transform:
    translate3d(0, var(--ty, 0px), 0)
    rotateX(var(--rx, 0deg))
    rotateY(var(--ry, 0deg));
}

/* Profundidad suave (sin cortar) */
.vignette .bg{
  z-index:1;
  transform:
    translate3d(0, var(--ty, 0px), 0)
    rotateX(var(--rx, 0deg))
    rotateY(var(--ry, 0deg))
    scale(1.1);
}
.vignette .mid{
  z-index:2;
  transform:
    translate3d(0, var(--ty, 0px), 0)
    rotateX(var(--rx, 0deg))
    rotateY(var(--ry, 0deg))
    scale(1.1);
}
.vignette .front{
  z-index:3;
  transform:
    translate3d(0, var(--ty, 0px), 0)
    rotateX(var(--rx, 0deg))
    rotateY(var(--ry, 0deg))
    scale(1.2);
}

.vignette .text{
  z-index:4;
  pointer-events:none;
}


/* ---------- CARRUSEL DE RUTAS (3 caminos) ---------- */

/* Contenedor del bloque de rutas */
.choice-strip{
  position:relative;
  z-index:1;
  width:100%;
  max-width:1280px;
  margin:8vh auto 10vh;   /* menos separación que antes */
  padding:0 16px;
}

/* Encabezado del bloque de rutas */
.choice-head{
  text-align:center;
  margin-bottom:24px;
}

.choice-heading{
  font-size:clamp(1.3rem, 2.6vw, 1.8rem); /* un poco más grande en PC */
  letter-spacing:.12em;
  text-transform:uppercase;
  color:var(--white-200);
}

/* Track horizontal con scroll (carrusel) */
.choice-grid{
  display:flex;
  gap:clamp(24px,4vw,48px);
  padding:10px 0 12px;
  overflow-x:auto;
  overflow-y:hidden;              /* << evita slider vertical interno  */
  scroll-snap-type:x mandatory;
  scroll-padding-left:0;
  -webkit-overflow-scrolling:touch;
  justify-content:flex-start;
  align-items:flex-start;
}

/* Scrollbar del carrusel */
.choice-grid::-webkit-scrollbar{ height:8px; }
.choice-grid::-webkit-scrollbar-track{ background:transparent; }
.choice-grid::-webkit-scrollbar-thumb{
  background:linear-gradient(90deg,#5145AC,#A08100);
  border-radius:8px;
}

/* Cada opción de ruta (“slide”) */
.choice-item{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:8px;
  flex:0 0 85vw;                 /* ancho grande en móvil/desktop */
  max-width:1200px;
}


.choice-item .vignette.is-tease{
  width:100%;
  height:70vh;
  margin-top:0;
    transform-origin:center bottom;
  scroll-snap-align:center;
  transition:
    transform .35s ease,
    box-shadow .35s ease,
    opacity .35s ease;
}

@media (max-width:768px){
  .choice-item .vignette.is-tease{
    height:64vh;          /* un poco menos alta en móvil */
  }
}

/* Ruta centrada: leve zoom, sombra y 100% opacidad */
.choice-item.is-current .vignette.is-tease{
  transform:scale(1.03);
  opacity:1;
  box-shadow:0 18px 45px rgba(0,0,0,.55);
}

/* Rutas laterales: un pelín más pequeñas y algo apagadas */
.choice-item.is-not-current .vignette.is-tease{
  transform:scale(0.96);
  opacity:.0;
  box-shadow:none;
}


/* MUY IMPORTANTE:
   Las rutas deben verse siempre, sin depender de is-active */
.choice-strip .vignette.is-tease .layer{
  opacity:1 !important;
}

/* Las rutas muestran SIEMPRE la viñeta completa (sin recorte) */
.vignette.is-tease .layer{
  background-size:contain;
  background-position:center;
}

/* Título arriba de cada teaser: Ruta Victor / Artiom / Faraday */
.route-name{
  font-size:clamp(1rem, 1.4vw, 1.2rem);  /* un poco más grande en PC */
  font-weight:700;
  text-transform:uppercase;
  letter-spacing:.12em;
  color:var(--gold);
    margin-bottom:60px;
  position:relative;
  z-index:5;

}

@media (max-width:768px){
  .route-name{
        margin-bottom:0px;

  }
}

/* ---------- Botones de decisión dentro de una viñeta ---------- */
.decision{
  position:absolute; bottom:14%; left:50%; transform:translateX(-50%);
  display:flex; gap:14px; z-index:10;
}
.decision button{
  background:rgba(0,0,0,.7);
  border:1px solid var(--gold); border-radius:12px;
  color:var(--white-100); font-weight:700; font-family:"Quantico";
  padding:10px 16px; cursor:pointer;
  transition:background .25s ease, transform .2s ease, border-color .2s ease;
}
.decision button:hover{
  background:rgba(160,129,0,.2);
  border-color:var(--purple);
  transform:translateY(-1px) scale(1.03);
}
.decision button:focus-visible{ outline:2px solid var(--gold); outline-offset:2px; }

/* ---------- Responsive extra ---------- */
@media (max-width:768px){
  .vignette{
    height:72vh;
  }
  .vignette.is-tease{
    height:65vh;
  }
  .decision{ bottom:12%; gap:10px; }
  .decision button{ padding:9px 14px; font-size:.95rem; }
}

@media (min-width:769px){
  .vignette{ height:70vh; }
}

.routes-top-btn{
  position:fixed;
  right:24px;
  bottom:28px;
  z-index:250;
  border-radius:999px;
  border:2px solid #3a3a42;  /* borde más grueso */
  background:rgba(0,0,0,.9);
  padding:10px 20px;         /* más grande */
  font-family:"Quantico", system-ui;
  font-size:.95rem;          /* un pelín más grande */
  letter-spacing:.08em;
  text-transform:uppercase;
  color:var(--white-100);
  cursor:pointer;
  box-shadow:0 10px 30px rgba(0,0,0,.6);
  backdrop-filter:blur(8px);
  transition:
    background .2s ease,
    transform .2s ease,
    border-color .2s ease,
    box-shadow .2s ease,
    opacity .2s ease;
}

.routes-top-btn:hover{
  background:rgba(160,129,0,.25);
  border-color:var(--gold);
  transform:translateY(-2px) scale(1.03);
  box-shadow:0 14px 40px rgba(0,0,0,.7);
}

.routes-top-btn:active{
  transform:translateY(0) scale(1.0);
}

@media (min-width:1200px){
  .routes-top-btn{
    right:20px;
    bottom:40px;
    padding:16px 32px;
    font-size:50px;
  }
}

#route-loading{
  position:fixed;
  inset:0;
  display:none;                 /* se activa con .is-visible */
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,.75);
  z-index:220;                  /* por encima de viñetas, por debajo del header si quieres */
}

#route-loading.is-visible{
  display:flex;
}

#route-loading .spinner{
  width:64px;
  height:64px;
  border-radius:50%;
  border:4px solid rgba(255,255,255,.15);
  border-top-color:var(--gold);
  animation:route-spin .8s linear infinite;
}

@keyframes route-spin{
  to{ transform:rotate(360deg); }
}
